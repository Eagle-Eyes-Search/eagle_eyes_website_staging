<style>
    .comparison-table {
      width: 98%;
      max-width: 1400px;
      margin: 3rem 0 0 2rem;
      border-collapse: collapse;
      background: white;
      border: 2px solid #e9ecef;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 8px 30px rgba(0, 0, 0, 0.08);
    }
    
    .comparison-table th,
    .comparison-table td {
      padding: 20px;
      text-align: center;
      border: 1px solid #e9ecef;
      vertical-align: top;
    }
    
    .comparison-table th {
      background: #f8f9fa;
      font-weight: 600;
      color: #333;
      border-bottom: 2px solid #dee2e6;
    }
    
    .comparison-table tr:nth-child(even) {
      background: #fafbfc;
    }
    
    .comparison-table tr:nth-child(odd) {
      background: white;
    }
    
    .comparison-table tr:hover {
      background: #f8f9fa;
    }
    
    .comparison-table tbody td {
      border-bottom: 1px solid #e9ecef;
      border-top: none;
    }
    
    .feature-name {
      text-align: left;
      font-weight: 500;
      color: #333;
      width: 30%;
      max-width: 300px;
      word-wrap: break-word;
      line-height: 1.4;
      padding-right: 15px;
    }
    
    .feature-check {
      color: #28a745;
      font-size: 18px;
      font-weight: bold;
    }
    
    .feature-x {
      color: #dc3545;
      font-size: 18px;
      font-weight: bold;
    }
    
    /* Fix alignment for table headers */
    .comparison-table th .section-title,
    .comparison-table th .section-description,
    .comparison-table th .section-price,
    .comparison-table th .section-info,
    .comparison-table th .section-button {
      text-align: center;
    }
    
    .comparison-table th .device-calculator {
      text-align: center;
    }
    
    .comparison-table th .pricing-formula {
      text-align: center;
    }
    
    .pricing-box:hover {
      /* Remove the upward translation */
      transform: none;
    }
    
    .inner-pricing-box {
      display: flex;
      flex-direction: column;
      height: 420px; /* Increased height for calculator */
      padding: 2.5rem 2rem;
      border: none;
      border-radius: 12px;
      background-color: #fff;
      box-shadow: 0 8px 30px rgba(0, 0, 0, 0.08);
      transition: box-shadow 0.3s ease;
      position: relative;
      overflow: hidden;
    }
    
    .pricing-box:hover .inner-pricing-box {
      box-shadow: 0 12px 40px rgba(0, 0, 0, 0.12);
    }

    .inner-pricing-box.trial {
        border: 2px solid #000000;
    }
    
    .inner-pricing-box.popular {
        border: none;
        background: linear-gradient(145deg, #ffffff, #f8fbff);
    }
    
    .popular-badge {
        position: absolute;
        top: 0;
        right: 0;
        background: var(--blue-highlight);
        color: white;
        font-size: 0.8rem;
        padding: 0.4rem 1.2rem;
        border-bottom-left-radius: 8px;
        font-weight: 600;
        letter-spacing: 0.5px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
    }

    /* 4 Sections for each pricing box */
    .section-title {
      padding: 0.3rem 0;
      height: 50px;  /* Reduced height */
      margin-bottom: 0.6rem;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .section-description {
      padding: 0.7rem 0;
      height: 90px;  /* Increased height for calculator input */
      margin-bottom: 0.8rem;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 90px;
    }

    .section-price {
      padding: 0.7rem 0;
      height: 80px;  /* Fixed height */
      margin-bottom: 0.8rem;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .section-info {
      padding: 0.3rem 0;
      height: 40px;  /* Fixed height */
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .section-button {
      padding: 0.5rem 0;
      height: 70px;  /* Fixed height */
      margin-top: auto;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    /* Modal styles */
    .modal {
      display: none;
      position: fixed;
      z-index: 1000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0,0,0,0.5);
    }
    
    .modal-content {
      background-color: #fefefe;
      margin: 15% auto;
      padding: 30px;
      border-radius: 12px;
      width: 90%;
      max-width: 600px;
      box-shadow: 0 8px 30px rgba(0,0,0,0.3);
      position: relative;
    }
    
    .close {
      color: #aaa;
      float: right;
      font-size: 28px;
      font-weight: bold;
      position: absolute;
      top: 15px;
      right: 20px;
      cursor: pointer;
    }
    
    .close:hover,
    .close:focus {
      color: #000;
      text-decoration: none;
    }
    
    .modal h3 {
      margin-top: 0;
      margin-bottom: 20px;
      color: #333;
      font-size: 1.5rem;
      font-weight: 600;
    }
    
    .modal p {
      margin-bottom: 15px;
      line-height: 1.6;
      color: #555;
    }
    
    .modal .bullet {
      text-align: center;
      font-size: 20px;
      color: #007bff;
      margin: 20px 0;
    }

    /* Title Section */
    .section-title h2 {
      font-size: 1.7rem;
      margin: 0;
      font-weight: 600;
      color: #333;
      line-height: 1.3;
    }
    
    /* Pricing Box Title Styling - smaller and more compact */
    .pricing-box .section-title h2 {
      font-size: 1.8rem;
      font-weight: 500;
      line-height: 1.2;
      max-width: 280px;
      margin: 0 auto;
      color: #444;
    }
    
    /* Description Section */
    .section-description p {
      margin: 0;
      color: #555;
      line-height: 1.6;
    }
    
    /* Price Section */
    .section-price .dollars {
      font-size: 2.2rem;
      margin: 0;
      font-weight: 500;
      color: #000000;
    }
    
    .fetching-price {
        font-size: 1.5rem;
        opacity: 0.7;
        font-style: italic;
        color: #666;
    }
    
    /* Button Section */
    .section-button button {
      display: block;
      padding: 10px 20px;
      font-size: 14px;
      font-weight: 600;
      border-radius: 4px;
      cursor: pointer;
      min-width: 160px;
      margin: 0 auto;
      transition: all 0.3s ease;
      /* Primary button styling (like button-black.html) */
      background-color: #000;
      color: #fff;
      border: 1px solid #000;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    }
    
    .section-button button:hover {
      background-color: #1e90ff;
      color: #fff;
      border: 1px solid transparent;
      /* Remove the upward translation */
      transform: none;
    }
    
    .section-button .secondary-button {
      /* Transparent button styling (like button-transparent-black.html) */
      background-color: transparent;
      color: #000;
      border: 1px solid #000;
      box-shadow: none;
    }
    
    .section-button .secondary-button:hover {
      background-color: #1e90ff;
      color: #fff;
      border: 1px solid transparent;
    }

    .lead {
        font-weight: 500;
        color: #555;
        font-size: 1.5rem;
        margin-bottom: 0.5rem;
        margin-top: 0;
        letter-spacing: 0.01em;
        font-family: inherit;
    }

    .license-explainer {
        flex: 1 1 100%;
        max-width: 800px;
        text-align: center;
        margin-top: 3rem;
        font-style: italic;
        margin-left: auto;
        margin-right: auto;
        color: #666;
        line-height: 1.6;
        padding: 1.5rem;
        /* background-color: rgba(245, 247, 250, 0.7); */
        border-radius: 10px;
    }

    /* Device Calculator Styles */
    .device-calculator {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 0.8rem;
    }
    
    .device-input-group {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        flex-wrap: wrap;
        justify-content: center;
    }
    
    .device-input {
        width: 80px;
        height: 40px;
        border: 1px solid #ddd;
        border-radius: 0;
        text-align: center;
        font-size: 16px;
        font-weight: 600;
        background-color: #fff;
        transition: border-color 0.3s ease;
        transform: translateY(6px);
        /* Hide number input spinners */
        -webkit-appearance: none;
        -moz-appearance: textfield;
    }
    
    .device-input::-webkit-outer-spin-button,
    .device-input::-webkit-inner-spin-button {
        -webkit-appearance: none;
        margin: 0;
    }
    
    .device-input:focus {
        outline: none;
        border-color: var(--blue-highlight);
    }
    
    .device-input:invalid {
        border-color: #ff6b6b;
    }
    
    .pricing-formula {
        font-size: 1.4rem;
        color: #666;
        text-align: center;
        line-height: 1.4;
        margin-top: 0.5rem;
    }

    @media (max-width: 768px) {
      .comparison-table {
        width: 98%;
        font-size: 14px;
        display: block;
        overflow-x: auto;
      }
      
      .comparison-table th,
      .comparison-table td {
        padding: 15px 10px;
        min-width: 120px;
      }
      
      .feature-name {
        min-width: 200px;
        max-width: 250px;
        font-size: 13px;
      }
      
      .device-calculator {
        gap: 0.5rem;
      }
      
      .pricing-formula {
        font-size: 1.1rem;
      }
      
      .section-title h2 {
        font-size: 1.4rem;
      }
      
      .lead {
        font-size: 1.2rem;
      }
    }

    @media (max-width: 480px) {
      .comparison-table {
        width: 95%;
        font-size: 12px;
        display: block;
        overflow-x: auto;
      }
      
      .comparison-table th,
      .comparison-table td {
        padding: 10px 5px;
        min-width: 100px;
      }
      
      .feature-name {
        min-width: 180px;
        max-width: 200px;
        font-size: 12px;
        line-height: 1.3;
      }
      
      .section-title h2 {
        font-size: 1.3rem;
      }
      
      .lead {
        font-size: 1.1rem;
      }
      
      .device-input {
        width: 50px;
        height: 30px;
        font-size: 12px;
      }
      
      .pricing-formula {
        font-size: 1rem;
      }
      
      .dollars {
        font-size: 1.8rem !important;
      }
    }

    /* Main heading - match with "Eagle Eyes Pilot for Android" on index.html */
    .pricing-header {
        /* Reset any custom styling */
        text-align: center;
        padding-left: 20px;
        padding-right: 20px;
    }
    
    .pricing-header h2 {
        text-align: center;
        margin-bottom: 30px; /* mb-30 equivalent */
        font-weight: inherit; /* Use the default h2 weight from your main stylesheet */
        font-size: inherit; /* Use the default h2 size from your main stylesheet */
        color: inherit; /* Use the default h2 color from your main stylesheet */
        line-height: inherit;
        letter-spacing: inherit;
    }

    /* Subheading - increase size and ensure font consistency */
    .pricing-header p {
        text-align: center;
        max-width: 800px;
        margin: 0 auto 3rem;
        color: #555;
        font-size: 1.8rem;
        line-height: 1.6;
        font-weight: 400;
        font-family: inherit;
    }

    /* Info links container styling */
    .info-links-container {
        text-align: center;
        margin: 2rem auto 3rem;
        max-width: 600px;
        padding: 1rem;
        font-size: 1.5rem;
        /* background-color: #f9f9f9;
        border-radius: 8px; */
    }
    
    .info-links-container p {
        margin-bottom: 0.8rem;
        color: #444;
    }
    
    .info-links-container p:last-child {
        margin: 0;
    }
    
    .info-links-container a {
        color: var(--blue-highlight);
        font-weight: 500;
        text-decoration: none;
        transition: all 0.3s ease;
    }
    
    .info-links-container a:hover {
        text-decoration: underline;
    }
    
    .info-links-container .flag {
        margin-left: 5px;
    }
</style>
  
  <div style="margin-top: 14rem; margin-bottom: 5rem;">
    <div class="pricing-header">
        <h2 style="margin-bottom: 30px; font-weight: 300; font-size: 2.8rem; color: #333; line-height: 1.2; text-align: center;">Choose Your Plan</h2>
        <p>Select the license that's right for your team.<br>All plans are for an annual subscription and include full access to all Eagle Eyes products and features.</p>
    </div>
    
    <div class="info-links-container">
      <p>Looking for Eagle Eyes Scan downloads? <a href="{{ '/account/' | relative_url }}">Create or access your account here.</a></p>

    </div>
    
    <!-- <div id="fetchingDiv" style="text-align: center; margin-bottom: 2rem;">⏳ Fetching pricing data...</div> -->
    <section class="section-container" style="padding: 0 0 4rem 0; margin-top: 8rem; max-width: 1400px; margin-left: auto; margin-right: auto;">
      <table class="comparison-table">
        <thead>
          <tr>
            <th style="width: 25%; background: transparent; border: none;"></th>
            <th style="width: 25%; background: linear-gradient(135deg, #f8f9fa 0%, #e3f2fd 100%); border-bottom: 3px solid #dee2e6; box-shadow: 0 2px 8px rgba(0,0,0,0.1); padding-top: 15px;">
              <p class="lead" style="font-size: 24px; font-weight: bold; margin-bottom: 10px;">FREE</p>
              <div class="section-description">
                <p>Access Eagle Eyes,<br>basic features for free</p>
              </div>
              <div class="section-price">
                <br>
                <br>
                <p class="dollars">USD $0</p>
                <br>
                <br>
                <br>
                <br>
              </div>
              <div class="section-button">
                <button class="secondary-button" style="min-width: 160px;">Get Eagle Eyes</button>
              </div>
            </th>
            <th style="width: 25%; border-left: 2px solid #dee2e6; background: linear-gradient(135deg, #f8f9fa 0%, #e3f2fd 100%); border-bottom: 3px solid #dee2e6; box-shadow: 0 2px 8px rgba(0,0,0,0.1); padding-top: 15px;">
              <p class="lead" style="font-size: 24px; font-weight: bold; margin-bottom: 10px;">PLUS</p>
              <div class="section-description">
                <p>Access all Eagle Eyes features<br>except real-time computer vision detection</p>
              </div>
              <div class="section-price">
                <br>
                <br>
                <p class="dollars">USD $50/year</p>
                <br>
                <br>
                <br>
                <br>
              </div>
              <div class="section-button">
                <button class="secondary-button" style="min-width: 160px;">Continue</button>
              </div>
              <div class="section-info">
                <button id="infoButtonPlus" style="background: none; border: none; color: #007bff; font-size: 14px; cursor: pointer; padding: 8px 12px; border-radius: 6px; display: flex; align-items: center; justify-content: center; margin: 0 auto; gap: 5px; text-decoration: underline;">ⓘ License Terms and Options</button>
              </div>
            </th>
            <th style="width: 25%; border-left: 2px solid #dee2e6; background: linear-gradient(135deg, #f8f9fa 0%, #e3f2fd 100%); border-bottom: 3px solid #dee2e6; box-shadow: 0 2px 8px rgba(0,0,0,0.1); padding-top: 15px;">
              <p class="lead" style="font-size: 24px; font-weight: bold; margin-bottom: 10px;">PRO (SEARCH)</p>
                        <div class="section-description">
            <p>Includes access to real-time Eagle Eyes,<br>Computer Vision Detection.</p>
          </div>
              <div class="section-title">
                <h2>Select number of devices</h2>
              </div>
              <div class="section-description">
                <div class="device-calculator">
                  <div class="device-input-group">
                    <div style="display: flex; align-items: center; justify-content: center; gap: 0;">
                      <button id="decreaseDevices" style="width: 35px; height: 40px; border: none; background: transparent; border-radius: 4px 0 0 4px; cursor: pointer; font-size: 18px; font-weight: 900;">−</button>
                      <input type="number" id="deviceCount" class="device-input" min="1" max="12" value="1">
                      <button id="increaseDevices" style="width: 35px; height: 40px; border: none; background: transparent; border-radius: 0 4px 4px 0; cursor: pointer; font-size: 18px; font-weight: 900;">+</button>
                      <span style="font-size: 14px; color: #666; margin-left: 8px;">device(s)</span>
                    </div>
                  </div>
                  <div class="pricing-formula">
                    USD $400 for 1st device<br>
                    +USD $150 per additional device<br>
                    <span id="customPricingText" style="font-size: 1.1rem; color: #888; font-style: italic; display: none;">* Custom pricing available for large organizations<br>
                    <a href="mailto:info@eagleeyessearch.com" style="color: var(--blue-highlight); text-decoration: none;">inquire at: info@eagleeyessearch.com</a></span>
                  </div>
                </div>
              </div>
              <div class="section-price">
                <p class="dollars" id="calculatedPrice">USD $400</p>
                <br>
              </div>
              <div class="section-button">
                <button style="min-width: 160px;" id="purchaseButton">Continue</button>
              </div>
              <div class="section-info">
                <button id="infoButton" style="background: none; border: none; color: #007bff; font-size: 14px; cursor: pointer; padding: 8px 12px; border-radius: 6px; display: flex; align-items: center; justify-content: center; margin: 0 auto; gap: 5px; text-decoration: underline;">ⓘ License Terms and Options</button>
              </div>
            </th>
          </tr>
        </thead>
        <tbody>
                    <tr>
            <td class="feature-name">Upload drone GPS flight track (flight log) to Caltopo</td>
            <td class="feature-check">✓</td>
            <td class="feature-check">✓</td>
            <td class="feature-check">✓</td>
          </tr>
          <tr>
            <td class="feature-name">Convert Caltopo Search areas into kml files for plug and play import into DJI flight planning software for automated search grids</td>
            <td class="feature-check">✓</td>
            <td class="feature-check">✓</td>
            <td class="feature-check">✓</td>
          </tr>
          <tr>
            <td class="feature-name">Airspace deconfliction over a local Wi-Fi network, linking the Eagle Eyes AirBoss map with CalTopo to show drones in relation to search areas and map features.</td>
            <td class="feature-check">✓</td>
            <td class="feature-check">✓</td>
            <td class="feature-check">✓</td>
          </tr>
          <tr style="background-color: #fff5f5;">
            <td class="feature-name" style="color: #aaa; font-weight: bold;">Cloud-based airspace deconfliction showing drones in relation to other drones and aircraft across different networks.</td>
            <td class="feature-x">✗</td>
            <td class="feature-check">✓</td>
            <td class="feature-check">✓</td>
          </tr>
            <tr>
              <td class="feature-name">Complete drone piloting app (fly your drone with Eagle Eyes Pilot)</td>
              <td class="feature-x">✗</td>
              <td class="feature-check">✓</td>
              <td class="feature-check">✓</td>
            </tr>
            <tr>
              <td class="feature-name">Real time Caltopo drone GPS tracking (adding geolocated photo points to Caltopo)</td>
              <td class="feature-x">✗</td>
              <td class="feature-check">✓</td>
              <td class="feature-check">✓</td>
            </tr>
            <tr style="background-color: #fff5f5;">
              <td class="feature-name" style="color: #aaa; font-weight: bold;">PUMP THE FEED!</td>
              <td class="feature-x">✗</td>
              <td class="feature-check">✓</td>
              <td class="feature-check">✓</td>
            </tr>
            <tr>
              <td class="feature-name">Real time computer vision detection (color and motion anomoly detection)</td>
              <td class="feature-x">✗</td>
              <td class="feature-x">✗</td>
              <td class="feature-check">✓</td>
            </tr>
            <tr>
              <td class="feature-name">Access to Eagle Eyes Scan CV detection, image and video processing capabilities</td>
              <td class="feature-x">✗</td>
              <td class="feature-x">✗</td>
              <td class="feature-check">✓</td>
            </tr>
        </tbody>
      </table>
    </section>
  </div>

  <!-- Modal -->
  <div id="infoModal" class="modal">
    <div class="modal-content">
      <span class="close">&times;</span>
      <h3>License Terms and Options</h3>
      <p>A verified account is required to purchase a license. Verification typically takes 1–3 business days.</p>
      <div class="bullet">•</div>
      <p>Once activated on a device, a license is permanently tied to that device. If a device is lost or another unexpected issue occurs, the Eagle Eyes team can help move your license to a replacement device on a case-by-case basis.</p>
      <div class="bullet">•</div>
      <p>Additional devices can be added at any time for a one-time fee of $20 for each month remaining in your current license term. For example, if you have 3 months left, the cost would be $60.</p>
    </div>
  </div>

  <!-- PLUS Modal -->
  <div id="infoModalPlus" class="modal">
    <div class="modal-content">
      <span class="close">&times;</span>
      <h3>License Terms and Options</h3>
      <p><strong>No verification required - available to everyone!</strong></p>
      <div class="bullet">•</div>
      <p>Up to 3 devices can be logged into a license at once.</p>
      <div class="bullet">•</div>
      <p>Additional devices can be added at any time for a one-time annual fee of $5 for each month remaining in your current license term. For example, if you have 3 months left, the cost would be $15.</p>
    </div>
  </div>
      </div>
    </section>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
        // Initialize device count calculator
        const deviceInput = document.getElementById('deviceCount');
        const decreaseBtn = document.getElementById('decreaseDevices');
        const increaseBtn = document.getElementById('increaseDevices');
        const priceDisplay = document.getElementById('calculatedPrice');
        const purchaseButton = document.getElementById('purchaseButton');
        
        function calculatePrice(deviceCount) {
            if (deviceCount < 1) return 400;
            if (deviceCount > 12) deviceCount = 12; // Cap at 12 devices
            if (deviceCount === 1) return 400;
            return 400 + (deviceCount - 1) * 150;
        }
        
        function updatePrice() {
            let deviceCount = parseInt(deviceInput.value) || 1;
            
            // Ensure device count is within valid range
            if (deviceCount > 12) {
                deviceCount = 12;
                deviceInput.value = 12;
            }
            if (deviceCount < 1) {
                deviceCount = 1;
                deviceInput.value = 1;
            }
            
            const price = calculatePrice(deviceCount);
            priceDisplay.textContent = `USD $${price.toLocaleString()}`;
            
            // Update button data attributes for purchase
            purchaseButton.setAttribute('data-device-count', deviceCount);
            
            // Show/hide custom pricing text based on device count
            const customPricingText = document.getElementById('customPricingText');
            if (deviceCount === 12) {
                customPricingText.style.display = 'inline';
            } else {
                customPricingText.style.display = 'none';
            }
        }
        
        // Handle input field changes (keyboard input)
        deviceInput.addEventListener('input', updatePrice);
        deviceInput.addEventListener('change', updatePrice);
        
        // Handle decrease button
        decreaseBtn.addEventListener('click', function() {
            let currentValue = parseInt(deviceInput.value) || 1;
            if (currentValue > 1) {
                deviceInput.value = currentValue - 1;
                updatePrice();
            }
        });
        
        // Handle increase button  
        increaseBtn.addEventListener('click', function() {
            let currentValue = parseInt(deviceInput.value) || 1;
            if (currentValue < 12) {
                deviceInput.value = currentValue + 1;
                updatePrice();
            }
        });
        
        // Initialize with default value
        updatePrice();
        
        // Modal functionality
        const modal = document.getElementById('infoModal');
        const modalPlus = document.getElementById('infoModalPlus');
        const infoButton = document.getElementById('infoButton');
        const infoButtonPlus = document.getElementById('infoButtonPlus');
        const closeButtons = document.querySelectorAll('.close');
        
        // Open modal when info button is clicked
        infoButton.addEventListener('click', function() {
            modal.style.display = 'block';
        });
        
        // Open PLUS modal when info button is clicked
        infoButtonPlus.addEventListener('click', function() {
            modalPlus.style.display = 'block';
        });
        
        // Close modals when X is clicked
        closeButtons.forEach(function(closeButton) {
            closeButton.addEventListener('click', function() {
                modal.style.display = 'none';
                modalPlus.style.display = 'none';
            });
        });
        
        // Close modals when clicking outside of them
        window.addEventListener('click', function(event) {
            if (event.target === modal) {
                modal.style.display = 'none';
            }
            if (event.target === modalPlus) {
                modalPlus.style.display = 'none';
            }
        });
        
        // Add click handlers to buttons
        document.querySelectorAll('.pricing-box').forEach((box, index) => {
            const button = box.querySelector('.section-button button');
            
            switch(index) {
                case 0: // First box (Free)
                    button.addEventListener('click', function() {
                        const url = new URL(getUrlWithEmulatorParam('{{ "/download/" | relative_url }}'), window.location.origin);
                        // Add machine_id if present in current URL
                        const currentMachineId = new URLSearchParams(window.location.search).get('machine_id');
                        if (currentMachineId) {
                            url.searchParams.set('machine_id', currentMachineId);
                        }
                        window.location.href = url.toString();
                    });
                    break;
                    
                case 1: // Device Calculator
                    button.addEventListener('click', function() {
                        const deviceCount = this.getAttribute('data-device-count');
                        
                        // Create a URL that includes device count information
                        const url = new URL(getUrlWithEmulatorParam('{{ "/account/?reason=purchase" | relative_url }}'), window.location.origin);
                        url.searchParams.set('device_count', deviceCount);
                        
                        // Add machine_id if present in current URL
                        const currentMachineId = new URLSearchParams(window.location.search).get('machine_id');
                        if (currentMachineId) {
                            url.searchParams.set('machine_id', currentMachineId);
                        }
                        
                        window.location.href = url.toString();
                    });
                    break;
                    

            }
        });
    });
    
    // Helper function to preserve emulator parameter
    function getUrlWithEmulatorParam(url) {
        const isEmulator = new URLSearchParams(window.location.search).get('is_emulator') === 'true';
        if (!isEmulator) return url;
        
        const separator = url.includes('?') ? '&' : '?';
        return url.includes('is_emulator=true') ? url : `${url}${separator}is_emulator=true`;
    }
  </script>