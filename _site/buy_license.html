<!DOCTYPE html>
<html>


<head>
	<meta charset="UTF-8" />
	<meta content="width=device-width,initial-scale=1.0,maximum-scale=1.0" name="viewport">

	<!-- Open Graph -->
	<meta property="og:title" content="Eagle Eyes" />
	<meta property="og:url" content="https://www.eagleeyessearch.com/" />
	<meta property="og:type" content="website" />
	<meta property="og:image" content="https://eagleeyessearch.com/images/eagle_eyes_logo_2.png" />
	<meta property="og:description" content="The Future of Aerial Search" />

	<!-- Twitter Theme -->
	<meta name="twitter:widgets:theme" content="light">
	
	<!-- Title &amp; Favicon -->
	<title>Eagle Eyes Search</title>
	<link rel="apple-touch-icon" sizes="180x180" href="images/favicon/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="images/favicon/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="images/favicon/favicon-16x16.png">
	<link rel="manifest" href="images/favicon/site.webmanifest">
	<link rel="mask-icon" href="images/favicon/safari-pinned-tab.svg" color="#5bbad5">
	<meta name="msapplication-TileColor" content="#da532c">
	<meta name="theme-color" content="#ffffff">

	<!-- Font -->
	<link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700%7CHind+Madurai:400,500&amp;subset=latin-ext" rel="stylesheet">
	
	<!-- Css -->
	<link rel="stylesheet" href="css/core.min.css" />
	<link rel="stylesheet" href="css/skin.css" />
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
	<link rel="shortcut icon" type="image/png" href="images/eagle_eyes_icon_rounded_filtered.png">
	<link rel="stylesheet" href="css/custom-styling.css" />

    <style>
        .content-grid-3 {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
        }
    </style>

	<!--[if lt IE 9]>
    	<script type="text/javascript" src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

	<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
	
	<!-- Enable Fathom -->
	<script src="https://cdn.usefathom.com/script.js" data-site="QAODRYUQ" defer></script>
	
	<!-- Hotjar Tracking Code for Site 5045439 (name missing) -->
	<script>
		(function(h,o,t,j,a,r){
			h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};
			h._hjSettings={hjid:5045439,hjsv:6};
			a=o.getElementsByTagName('head')[0];
			r=o.createElement('script');r.async=1;
			r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;
			a.appendChild(r);
		})(window,document,'https://static.hotjar.com/c/hotjar-','.js?sv=');
	</script>
	<script>
	$(document).ready(function() {
		$('nav.overlay-navigation a').click(function() {
			$('.overlay-navigation-wrapper').hide(); // this will hide the element
			$('body').css('overflow', 'auto');
			$('html').css('overflow', 'auto');
			$('body').removeClass('no-scroll');
			$('html').removeClass('no-scroll');
			// Hacky stuff
			// or
			//$('.v-align-middle').removeClass('v-align-middle'); // this will remove the class
		});
	});
	</script>

</head>

<head>
  <!-- Add necessary meta tags and other head elements here -->

  <style>
    .banner {
      position: relative;
      height: 100px; /* Adjust as needed */
      width: 100%;
      overflow: hidden; /* to contain the pseudo element */
    }
  
    .banner::before {
      content: "";
      position: absolute;
      top: 0; left: 0; right: 0; bottom: 0;
      background: url('/images/eagle_eyes_website_header_bg.jpg') no-repeat center;
      background-size: cover;
      filter: brightness(50%);
      z-index: 1; /* to ensure it's below other content */
    }
  
    .banner-text, .banner-img {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      z-index: 2; /* to ensure it's above the background */
    }
   .banner-link img {
      width: 100px; /* adjust as per requirement */
      height: 50px;
       align-content: flex-start;
       z-index: 2;
       position: absolute;
       top: 20%;
    }
  
    /* Modern looking font */
    .lead {
      width: 80%;
      margin: auto;
      font: 1.2em/1.5em "Hind Madurai", sans-serif;
    }
    </style>
</head>

<body class="shop home-page">
  <div class="banner">
    <a class="banner-link" href="/">
      <img src="/images/back_to_eagleeyes.png"/>
    </a>
    <!-- <div class="banner-text">Eagle Eyes Scan</div> -->
    <img class="banner-img" src="/images/eagle_eyes_flat_logo_2.png" style="width:30%"/>
  </div>
    
  <section class="content evensection">
      <div class="lead">
        <head>
<!-- Include Firebase SDK -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>

<!-- Include form_buttons_and_boxes.scss (it's in scss/form_buttons_and_boxes.scss) but we need to get it in liquid -->
<style src="/css/form_buttons_and_boxes.css"></style>
<link rel="stylesheet" href="/css/form_buttons_and_boxes.css">
<style>
    .explainer {
        display: none;
    }

    /* Style the plus/minus signs */
    .column-drowpdown .toggle {
        cursor: pointer;
        font-size: 2rem; /* Make the signs larger */
        display: flex;
        align-items: center;
        justify-content: center;
        height: 100%; /* Ensure it takes the full height of the container */
        padding-right: 10px; /* Add padding to the right */
    }

    /* Add a class for the minus sign */
    .column-drowpdown .toggle.minus {
        content: "-";
    }

    .section-block.feature {
        display: flex;
        justify-content: space-evenly;
        align-items: center;
        flex-direction: row; /* Default to row layout */
    }

    .section-block.feature .content {
        flex: 0 0 35%; /* Adjust flex-basis to 35% */
        max-width: 35%; /* Ensure it doesn't exceed 35% */
        padding: 1em;
        text-align: justify;
    }

    .section-block.feature .media {
        flex: 0 0 50%; /* Adjust flex-basis to 55% */
        max-width: 45%; /* Ensure it doesn't exceed 55% */
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .section-block.feature .media-inner {
        width: 100%;
        padding-bottom: 56.25%; /* 16:9 aspect ratio */
        position: relative;
        border: 1px solid black; /* Move border styling here */
    }

    .section-block.feature .media img,
    .section-block.feature .media iframe {
        width: 100%;
        height: 100%;
        position: absolute;
        top: 0;
        left: 0;
        object-fit: cover;
    }

    .section-container {
        width: 80%;
        margin: 0 auto;
        margin-bottom: 0; /* or decrease the value if it's not zero */
        padding-bottom: 0; /* or decrease the value if it's not zero */
    }

    /* Media query for narrow screens */
    @media (max-width: 768px) {
        .section-block.feature {
            flex-direction: column; /* Stack content in a column */
            align-items: center; /* Center items */
            text-align: center; /* Center text */
            padding: 0; /* Reset padding for mobile view */
        }

        .section-block.feature .content,
        .section-block.feature .media {
            width: 100%; /* Full width for mobile view */
            max-width: 100%; /* Ensure it takes the full width */
            padding: 1em; /* Add padding */
        }

        .section-block.feature .content h2 {
            font-size: 1.5em; /* Adjust title size if needed */
            margin-bottom: 1em;
        }

        .section-block.feature .content p {
            font-size: 1em; /* Adjust text size if needed */
            text-align: justify;
            margin-bottom: 1em; /* Reduce space below text */
        }

        .section-block.feature .media {
            margin-bottom: 1em; /* Reduce whitespace */
        }

        .section-container {
            margin-top: 5em; /* Add space above section containers */
            margin-bottom: 1em; /* Reduce whitespace between sections */
        }

        .v-align-middle > .button {
            display: none;
        }

        .feature-title {
            text-align: center;
        }
    }

    /* Media query for screens wider than 769px */
    @media (min-width: 769px) {
        #scan .content {
            order: 1; /* Move the text to the right */
        }

        #scan .media {
            order: 2; /* Move the image to the left */
        }

        #pilot .content {
            order: 1; /* Keep the text on the left */
        }

        #pilot .media {
            order: 2; /* Keep the video on the right */
        }

        /* Base styles for the feature section */
        .section-block.feature .content h2 {
            font-size: 3rem; /* Default font size */
            /* Add responsive font sizing */
            font-size: calc(1.5rem + 1vw); /* Responsive font size */
        }

    }	
</style>
</head>
</br>
<section id="login_title" hidden>
    </br>
    <h2 style="text-align: center;">Eagle Eyes Login</h2>
</section>
    <div style="display: flex; justify-content: center;">
        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
<!-- Include form_buttons_and_boxes.scss (it's in scss/form_buttons_and_boxes.scss) but we need to get it in liquid -->
<style src="/css/form_buttons_and_boxes.css"></style>
<link rel="stylesheet" href="/css/form_buttons_and_boxes.css">


<script>

    class SigninWidget {
        constructor(
            firebaseConfig,
            useLocalFirebaseEmulator = false,

        ) {
            this.useLocalFirebaseEmulator = useLocalFirebaseEmulator;
            this.firebaseConfig = firebaseConfig;
            firebase.initializeApp(firebaseConfig);
            // Upon initialization, call the function to initialize Firebase
            
            this._user = null;

            // Check if user is still signed in from a previous session
            firebase.auth().onAuthStateChanged(user => {
                if (user) {
                    this._user = user;
                    console.log("User is signed in", user);
                    this.updateUserDisplay(user);
                    this.fireSigninEvent(user);
                } else {
                    console.log("No user is signed in.");
                    this.completeEmailLinkSigninIfApplicable();
                }
            });


        }


        signInWithGoogle() {
            var provider = new firebase.auth.GoogleAuthProvider();
            provider.addScope('email');
            firebase.auth().signInWithPopup(provider).then((result) => {
                this._user = result.user;
                this.updateUserDisplay(this._user);
                this.fireSigninEvent(this._user);
            }).catch((error) => {
                console.error('Error during Google sign in: ', error);
            });
        }

        signInWithEmailLink(returnURL = null) {
            if (!returnURL) {
                returnURL = window.location.href;
            }
            var email = document.getElementById('email').value;
            var baseURL = window.location.origin;
            console.log('baseURL: ', baseURL);
            console.log('window.location.href: ', window.location.href);
            console.log('returnURL: ', returnURL);
            var actionCodeSettings = {
                // Make sure this URL is the URL of the page where you will handle the sign-in link
                // url: `${baseURL}/get_licensed/?machine_id=${machineId}`,
                // Get the full url including args that this page was loaded with
                // url: window.location.href,
                // url: `${baseURL}/get_scan`,
                url: returnURL,
                handleCodeInApp: true
            };

            console.log("Sending action code to email: ", email, " with settings: ", actionCodeSettings);
            firebase.auth().sendSignInLinkToEmail(email, actionCodeSettings)
                .then(() => {
                    window.localStorage.setItem('emailForSignIn', email);

                    // Now, replace sign-in-div with an info box telling the user to check their email
                    var signInDiv = document.getElementById('sign-in-div');
                    signInDiv.innerHTML = 'Sign-in link sent to ' + email +
                        ".  Be sure to check your spam folder if you don't see it in your inbox." +
                        "<br/><br/>You can now close this tab.";

                    // And give it a light-blue background to draw attention
                    signInDiv.classList.add('info-box');

                    console.log('Sign-in email sent to ' + email);
                    // alert('Sign-in email sent to ' + email + ".  Be sure to check your spam folder if you don't see it in your inbox.");
                })
                .catch((error) => {
                    console.error('Error sending sign-in email: ', error);
                    // Append the error message in a div to the end of the body
                    var errorDiv = document.createElement('div');
                    errorDiv.innerHTML = 'Error sending sign-in email: ' + error.message;
                    errorDiv.classList.add('error-box');
                    document.body.appendChild(errorDiv);

                });

        }

        // Call this function on the page where users are redirected after clicking the sign-in link
        completeEmailLinkSigninIfApplicable() {
            // If user is not already signed in and the URL has a sign-in link
            if (firebase.auth().isSignInWithEmailLink(window.location.href)) {
                console.log('Email link sign-in detected');
                // Get the email if it's saved in local storage
                var email = window.localStorage.getItem('emailForSignIn');
                console.log('... with email: ', email);
                if (!email) {
                    // User opened the link on a different device. You will need to prompt them for their email
                    email = window.prompt('Please provide your email for confirmation');
                }

                firebase.auth().signInWithEmailLink(email, window.location.href)
                    .then((result) => {
                        console.log('Email Link sign in successful: ', JSON.stringify(result));
                        window.localStorage.removeItem('emailForSignIn'); // Clear the email from local storage

                        // var destringifiedUser = JSON.parse(JSON.stringify(result.user));
                        // console.log("destringifiedUser: ", JSON.stringify(destringifiedUser));
                        // User is signed in
                        this._user = result.user;
                        console.log('User signed in: ', this._user);
                        this.updateUserDisplay(this._user);
                        this.fireSigninEvent(this._user);
                        // checkLicence(); // Call checkLicence after successful login

                        // Optional: Redirect to another page after successful sign in
                    })
                    .catch((error) => {
                        console.error('Error during Email Link sign in: ', error);

                        // Make the sign-in div an error class and display the error
                        var signInDiv = document.getElementById('sign-in-div');
                        signInDiv.innerHTML = 'Error during Email Link sign in.  Most likely, the link has been used already or is expired.  Please try again, and contact info@eagleeyessearch.com if you continue to have trouble.';
                        signInDiv.classList.add('error-box');
                        // And add a button to reload the page without the user info attached
                        signInDiv.innerHTML += '<br/><button onclick="location.reload()"  class="non_important_button">Reload</button>';

                    });
            }
        }

        fireSigninEvent(user) {
            console.log('Firing signInComplete event with user: ', user);
            const event = new CustomEvent('signInComplete', { detail: { user: user } });
            document.dispatchEvent(event);
        }

        updateUserDisplay(user) {

            document.getElementById('user-info').innerHTML = 'Signed in as: ' + user.email + ' ( ' + user.displayName + ' )';
            // Give it that nice blue background by turning it into a .info-box
            document.getElementById('user-info').classList.add('info-box');
            document.getElementById('sign-in-div').style.display = 'none';
            // document.getElementById('user-info').innerHTML += '<br/><button onclick="location.reload()"  class="non_important_button">Change user</button>';
            // Need to sign-out now
            document.getElementById('user-info').innerHTML += '<br/><button onclick="signOutAndChangeUser()"  class="non_important_button">Change user</button>';
        }


        getUser() {
            return this._user;
        }
    }


    function signOutAndChangeUser() {
        firebase.auth().signOut().then(() => {
            console.log('User signed out.');
            // Reset the user display or redirect to the login page
            location.reload()
        }).catch((error) => {
            console.error('Sign out error', error);
        });
    }

    const signinWidget = new SigninWidget(
        {
            apiKey: "AIzaSyAL9w9qClktCNFM1XSfo_HB59nU6zHI0bk",
            authDomain: "eagleeyessearch.firebaseapp.com",
            projectId: "eagleeyessearch",
            storageBucket: "eagleeyessearch.appspot.com",
            messagingSenderId: "983592831720",
            appId: "1:983592831720:web:57b3880d0185ea3110575d",
            measurementId: "G-J057SPR81M"
        },
        false
    );

    function getIsEmulatorFromURL() {
        // Just see if there's an "is_emulator=true" in the URL
        var url = new URL(window.location.href);
        var isEmulator = url.searchParams.get("is_emulator");

        return isEmulator === "true";
    }

    function getHostUrl(){
                
        var useLocalFirebaseEmulator = getIsEmulatorFromURL();  // When running local emulator with "firebase emulators:start", set this to "true
        // var useLocalFirebaseEmulator = true;  // When running local emulator with "firebase emulators:start", set this to "true
        var hostURL = useLocalFirebaseEmulator ? 'http://127.0.0.1:5001/eagleeyessearch/us-central1' : 'https://us-central1-eagleeyessearch.cloudfunctions.net';
        console.log('useLocalFirebaseEmulator: ', useLocalFirebaseEmulator);
        console.log('hostURL: ', hostURL);
        
        return hostURL;
    }

    // document.addEventListener("DOMContentLoaded", function () {
    //     // Initialize menus to be hidden
    //     var menus = document.getElementsByClassName('menu-content');
    //     for (var i = 0; i < menus.length; i++) {
    //         menus[i].style.display = "none";
    //     }
    //     // onSelectLicenceToken();
    //     completeSignInWithEmailLinkIfApplicable();
    //     return;
    // });


    function showEmailInputBtn() {
        // Show the email sign-in form
        document.getElementById('email-sign-in-form').style.display = 'block';
        // Hide the initial button
        document.getElementById('showEmailInputBtn').style.display = 'none';
        // And the google-sign-in button
        document.getElementById('google-sign-in-btn').style.display = 'none';
        // Focus on the email input for user convenience
        document.getElementById('email').style.display = 'block'; // Make sure email input is visible
        document.getElementById('email').focus();
    }

</script>

<div id='sign-in-div'>


    <button id="google-sign-in-btn" onclick="signinWidget.signInWithGoogle()">Sign in with Google</button>
    or

    <div id="email-sign-in-form" style="display:none;">
        <input type="email" id="email" placeholder="Email" style="display:none;width:80%">

        <!-- Add a cancel button that just reloads this page from scratch -->
        <button onclick="location.reload()" class="non_important_button">Cancel</button>

        <button id="sendSignInLinkBtn" onclick="signinWidget.signInWithEmailLink()">Send Sign in Link</button>
    </div>
    <button id="showEmailInputBtn" onclick="showEmailInputBtn()">Sign In With Email</button>
    <!-- <script>
    document.addEventListener("DOMContentLoaded", function () {
        // Event listener for the button to show email input
        document.getElementById('showEmailInputBtn').addEventListener('click', function () {
            // Show the email sign-in form
            document.getElementById('email-sign-in-form').style.display = 'block';
            // Hide the initial button
            this.style.display = 'none';
            // And the google-sign-in button
            document.getElementById('google-sign-in-btn').style.display = 'none';
            // Focus on the email input for user convenience
            document.getElementById('email').style.display = 'block'; // Make sure email input is visible
            document.getElementById('email').focus();
        });

        // Attach the signInWithEmailLink function to the Send SignIn Link button
        // document.getElementById('sendSignInLinkBtn').addEventListener('click', function () {
        //     signInWithEmailLink();
        // });
    });

</script> -->
</div>
<p id="user-info"></p>
    </div>
<section id="pricing_content" style="font-size: 80%;" hidden>

    <style>
    .feature-highlights {
        display: flex;
        justify-content: space-between; /* Ensure space between the containers */
        max-width: 1000px; /* Maximum width of the table */
        padding: 20px; /* Optional: padding around the main container */
        flex-wrap: wrap; /* Allow wrapping if there's not enough space */
        margin: 0 auto; /* Center the container horizontally */
        margin-top: 0; /* or decrease the value if it's not zero */
        padding-top: 0; /* or decrease the value if it's not zero */
        margin-bottom: 50px;
    }

    .sub-container {
        flex: 1 1 calc(33.33% - 20px); /* Adjust to fit 3 containers in one row */
        margin: 10px; /* Add padding between the containers */
        padding: 15px; /* Internal padding within each container */
        box-sizing: border-box; /* Ensure padding is included in the width */
        text-align: center; /* Center align text and images */
    }

    .sub-container img.icon {
        width: 50px; /* Adjust the size of the icon */
        height: auto; /* Maintain aspect ratio */
        margin-bottom: 10px; /* Space between the icon and the title */
    }

    .sub-container h3 {
        font-weight: bold;
        margin: 10px 0; /* Space between the title and the description */
    }

    .sub-container p {
        margin: 10px 0; /* Space between elements */
    }

    /* Adjust the margin for the first and last sub-container to remove extra space */
    .sub-container:first-child {
        margin-left: 0;
    }

    .sub-container:last-child {
        margin-right: 0;
    }

</style>

<div class="centered-feature bkg-grey-ultralight" style="padding-bottom: 20px;"> 
    <!-- <h3 class="weight-bold mb-30" style="text-align: center">Available Tiers</h3> -->
    <div class="plan-header">
        <div class="column-dropdown"></div> <!-- Empty cell for alignment -->
        <div class="column-feature"></div> <!-- Empty cell for alignment -->
        <div class="column-free"><h3>Free</h3></div>
        <div class="column-pro"><h3>SAR</h3></div>
    </div>
    <div class="plan-row">
        <div class="column-drowpdown"><span class="toggle">+</span></div>
        <div class="column-feature">File sync & organization</div>
        <div class="column-free"><i class="fas fa-check text-success"></i></div>
        <div class="column-pro"><i class="fas fa-check text-success"></i></div>
    </div>
    <div class="plan-row explainer" hidden>
        <div class="column-drowpdown"></div>
        <div class="column-feature"><i>Sync recent recordings from your drone's SD card to your laptop seamlessly.<br/> 
            Keep your videos and images organized in case files.</i>
            </div>
        <div class="column-free"></div>
        <div class="column-pro"></div>
    </div>
    <div class="plan-row">
        <div class="column-drowpdown"><span class="toggle">+</span></div>
        <div class="column-feature">Advanced inspection tools</div>
        <div class="column-free"><i class="fas fa-check text-success"></i></div>
        <div class="column-pro"><i class="fas fa-check text-success"></i></div>
    </div>
    <div class="plan-row explainer" hidden>
        <div class="column-drowpdown"></div>
        <div class="column-feature"><i>Inspect videos, images, frames, and pixels in detail using advanced frame and zoom controls.</i>
            </div>
        <div class="column-free"></div>
        <div class="column-pro"></div>
    </div>
    <div class="plan-row">
        <div class="column-drowpdown"><span class="toggle">+</span></div>
        <div class="column-feature">Annotation & bookmarks</div>
        <div class="column-free"><i class="fas fa-times text-danger"></i></div>
        <div class="column-pro"><i class="fas fa-check text-success"></i></div>
    </div>
    <div class="plan-row explainer" hidden>
        <div class="column-drowpdown"></div>
        <div class="column-feature"><i>Annotate files and create a library of bookmarked objects of interest for reference.</i>
            </div>
        <div class="column-free"></div>
        <div class="column-pro"></div>
    </div>
    <div class="plan-row">
        <div class="column-drowpdown"><span class="toggle spotlight">+</span></div>
        <div class="column-feature">Livestream support</div>
        <div class="column-free"><i class="fas fa-times text-danger"></i></div>
        <div class="column-pro"><i class="fas fa-check text-success"></i></div>
    </div>
    <div class="plan-row explainer" hidden>
        <div class="column-drowpdown"></div>
        <div class="column-feature"><i>Connect your drone’s controller to record and analyze live streams effortlessly (HDMI capture card required).<br/>
            Pause live streams at any time and go back in time to revisit footage.<br/>
            Monitor live folders for new images as they are captured.</i>
            </div>
        <div class="column-free"></div>
        <div class="column-pro"></div>
    </div>
    <div class="plan-row">
        <div class="column-drowpdown"><span class="toggle">+</span></div>
        <div class="column-feature">Automatic Detection-System</div>
        <div class="column-free"><i class="fas fa-times text-danger"></i></div>
        <div class="column-pro"><i class="fas fa-check text-success"></i></div>
    </div>
    <div class="plan-row explainer" hidden>
        <div class="column-drowpdown"></div>
        <div class="column-feature"><i>Scan live or pre-recorded footage on color and motion anomalies without delays.<br/>
            Sort detections by the rarity of their color, or how well they match a chosen color.</i> 
            </div>
        <div class="column-free"></div>
        <div class="column-pro"></div>
    </div>
    <div class="plan-row">
        <div class="column-drowpdown"><span class="toggle">+</span></div>
        <div class="column-feature">PDF Reports</div>
        <div class="column-free"><i class="fas fa-times text-danger"></i></div>
        <div class="column-pro"><i class="fas fa-check text-success"></i></div>
    </div>
    <div class="plan-row explainer" hidden>
        <div class="column-drowpdown"></div>
        <div class="column-feature"><i>Export bookmarks in PDF format with drone coverage, images of objects of interest, and their locations, to send to your team.</i> 
        </div>
        <div class="column-free"></div>
        <div class="column-pro"></div>
    </div>
    <div class="plan-row">
        <div class="column-drowpdown"><span class="toggle">+</span></div>
        <div class="column-feature">KML export for SARtopo & Google Earth</div>
        <div class="column-free"><i class="fas fa-times text-danger"></i></div>
        <div class="column-pro"><i class="fas fa-check text-success"></i></div>
    </div>
    <div class="plan-row explainer" hidden>
        <div class="column-drowpdown"></div>
        <div class="column-feature"><i>Share drone flight paths and objects of interest via KML export.<br/>
            Import these KML files in your preferred mapping tool to update your team on where the drone has searched and where objects were found.</i>
            </div>
        <div class="column-free"></div>
        <div class="column-pro"></div>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Initialize the explainer rows to be hidden by default
        document.querySelectorAll('.explainer').forEach(explainer => {
            explainer.style.display = 'none';
        });

        // Automatically open the first feature
        const spotlight = document.querySelector('.spotlight');
        if (spotlight) {
            const firstExplainer = spotlight.closest('.plan-row').nextElementSibling;
            if (firstExplainer && firstExplainer.classList.contains('explainer')) {
                firstExplainer.style.display = 'table-row';
                spotlight.textContent = '−';
            }
        }

        // Add click event listener to all toggles
        document.querySelectorAll('.toggle').forEach(toggle => {
            toggle.addEventListener('click', function() {
                const isActive = this.textContent === '−';
                
                // Close all explainers
                document.querySelectorAll('.explainer').forEach(explainer => {
                    explainer.style.display = 'none';
                });
                // Reset all toggles to plus
                document.querySelectorAll('.toggle').forEach(toggle => {
                    toggle.textContent = '+';
                });

                // Open the clicked explainer if it was not already active
                if (!isActive) {
                    const explainer = this.closest('.plan-row').nextElementSibling;
                    if (explainer && explainer.classList.contains('explainer')) {
                        explainer.style.display = 'table-row';
                        this.textContent = '−';
                    }
                }
            });
        });
    });
</script>
    </br>

    <!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Pricing Table</title>
<style>
    .pricing-table {
        width: 100%;
        max-width: 600px;
        margin: auto;
        padding: 20px;
        box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    .pricing-row {
        display: flex;
        justify-content: space-between;
        margin-bottom: 10px;
    }
    .pricing-row > div {
        flex: 1;
        padding: 10px;
        text-align: center;
    }
    .pricing-header > div {
        font-weight: bold;
        text-align: center;
    }
    .clickable {
        cursor: pointer;
        background-color: #f0f0f0;
        transition: background-color 0.3s;
    }
    .clickable:hover {
        background-color: #e0e0e0;
    }
    .clickable.selected {
        background-color: #cacaca;
    }
</style>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
</head>
<body>
<div class="centered-feature pricing-table bkg-grey-ultralight">
    <div><h3 class="weight-bold mb-30" style="text-align: center; margin-bottom: 0px;">SAR License Pricing</h3></div>
    <div style="text-align: center; font-size: 85%; font-style: italic; margin-bottom: 20px;">All prices are in USD. No auto-renewals.</div>
    <div class="pricing-header">
        <div class="keys"></div> <!-- Empty cell for alignment -->
        <div class="one-week"><h4>1 Week</h4></div>
        <div class="three-months"><h4>3 Months</h4></div>
        <div class="one-year"><h4>1 Year</h4></div>
    </div>
    <div id="fetchingDiv" style="text-align: center">⏳ Fetching pricing data...</div>
    
    <div id="pricing-rows-container"></div> <!-- Dynamic rows will be appended here -->
    <div style="font-style: italic; text-align: center; font-size: 85%; margin-top: 15px;">
        * A key unlocks the license on a single device. Once issued, keys cannot be revoked or transferred to another device.
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        fetchPricingData();
    });
    
    // This line enables Jekyll to pass the clickable parameter when including this file
    const isTableClickable = true;
    
    function getIsEmulatorFromURL() {
        const urlParams = new URLSearchParams(window.location.search);
        return urlParams.get('is_emulator') === 'true';
    }
    
    const useLocalFirebaseEmulator = getIsEmulatorFromURL();
    const hostURL = useLocalFirebaseEmulator ? 
        'http://127.0.0.1:5001/eagleeyessearch/us-central1' : 
        'https://us-central1-eagleeyessearch.cloudfunctions.net';
    
    function fetchPricingData() {
        var fetch_url = hostURL + '/get_product_line';
        console.log("Fetch URL: " + fetch_url);
    
        $.ajax({
            url: fetch_url,
            method: 'GET',
            success: function(data) {
                console.log('Fetched pricing data:', data);
                transformAndPopulatePricingTable(JSON.parse(data));
                $('#fetchingDiv').hide();
            },
            error: function(jqXHR, textStatus, errorThrown) {
                console.error('Error fetching pricing data:', textStatus, errorThrown);
                $('#fetchingDiv').text('❌ Error fetching pricing data from server');
            }
            // Whatever the outcome, hide the fetchingDiv div
        })
    }
    
    function transformAndPopulatePricingTable(newPricingData) {
        const pricingData = [];
        Object.keys(newPricingData).forEach((key) => {
            const item = newPricingData[key];
            if (!pricingData[item.n_keys]) {
                pricingData[item.n_keys] = {
                    keys: item.n_keys + ' key' + (item.n_keys > 1 ? 's' : ''),
                    'one-week': '-',
                    'three-months': '-',
                    'one-year': '-',
                    product_ids: {}, // To hold product_ids for different durations
                    product_names: {} // To hold product_names for different durations
                };
            }
            const priceFormat = '$' + item.price_usd;
            if (item.duration_days <= 7) {
                pricingData[item.n_keys]['one-week'] = priceFormat;
                pricingData[item.n_keys].product_ids['one-week'] = key;
                pricingData[item.n_keys].product_names['one-week'] = item.name;
            } else if (item.duration_days <= 93) {
                pricingData[item.n_keys]['three-months'] = priceFormat;
                pricingData[item.n_keys].product_ids['three-months'] = key;
                pricingData[item.n_keys].product_names['three-months'] = item.name;
            } else {
                pricingData[item.n_keys]['one-year'] = priceFormat;
                pricingData[item.n_keys].product_ids['one-year'] = key;
                pricingData[item.n_keys].product_names['one-year'] = item.name;
            }
        });
        populatePricingTable(Object.values(pricingData)); // Convert to array to populate table
    }
    
    function populatePricingTable(pricingData) {
        const container = document.getElementById('pricing-rows-container');
        pricingData.forEach(item => {
            const row = document.createElement('div');
            row.className = 'pricing-row';
            row.innerHTML = `
                <div class="keys">${item.keys}</div>
                <div class="one-week ${item['one-week'] !== '-' && isTableClickable ? 'clickable' : ''}" data-product-id="${item.product_ids['one-week']}" data-product-name="${item.product_names['one-week']}">${item['one-week']}</div>
                <div class="three-months ${item['three-months'] !== '-' && isTableClickable ? 'clickable' : ''}" data-product-id="${item.product_ids['three-months']}" data-product-name="${item.product_names['three-months']}">${item['three-months']}</div>
                <div class="one-year ${item['one-year'] !== '-' && isTableClickable ? 'clickable' : ''}" data-product-id="${item.product_ids['one-year']}" data-product-name="${item.product_names['one-year']}">${item['one-year']}</div>
            `;

            container.appendChild(row);
        });
    
        if (isTableClickable) {
            addClickEvents();
        }
    }
    
    function addClickEvents() {
        document.querySelectorAll('.clickable').forEach(element => {
            element.addEventListener('click', function() {
                document.querySelectorAll('.clickable.selected').forEach(e => e.classList.remove('selected'));
                this.classList.add('selected');
                const productId = this.getAttribute('data-product-id');
                const productName = this.getAttribute('data-product-name');
                const price = this.textContent;
                document.dispatchEvent(new CustomEvent('priceSelected', { detail: { product_id: productId, price: price, name: productName } }));
                console.log(`Dispatched priceSelected event for product_id: ${productId}, price: ${price}`);
            });
        });
    }
    </script>
    
</body>
</html>


    </br>
    <div style="text-align: center;">
        <div style="font-size: 85%; margin-top: 10px;">* If you have not already registered for a SAR license, you will be directed to register first.</div>
        <button id="purchaseButton" class="purchase-button" disabled>Select a License type to Purchase</button>
        <!-- Light grey text under button that users will need to register for approval before making a purchase -->
    </div>

    <div id="status-message"></div>
</section>

<script>
    var globalUser = null;
    $("#pricing_content").hide();
    $("#login_title").show(); 

    document.addEventListener('signInComplete', function (e) {
        globalUser = e.detail.user;
        console.log('signInComplete event received:', globalUser);
        $("#login_title").hide();
        $("#pricing_content").show();
    });

    document.addEventListener('DOMContentLoaded', function() {
        const purchaseButton = document.getElementById('purchaseButton');

        // Initially disable the purchase button until a price is selected
        purchaseButton.disabled = true;
        purchaseButton.classList.remove('enabled');

        // Listen for the priceSelected event from the pricing table
        document.addEventListener('priceSelected', function(e) {
            purchaseButton.disabled = false; // Enable the button when a price is selected
            purchaseButton.classList.add('enabled'); // Add the 'enabled' class for visual change
            purchaseButton.innerText = `Purchase ${e.detail.name} License`; // Update the button text
            purchaseButton.onclick = () => purchase(e.detail.product_id); // Assign the purchase function with the selected price
        });

        // Optionally handle price deselection or resetting
        document.addEventListener('clearSelections', function() {
            purchaseButton.disabled = true; // Disable the button
            purchaseButton.classList.remove('enabled'); // Remove the 'enabled' class for visual revert
        });
    });

    function purchase(product_id) {
        console.log("Purchasing product with id:", product_id);
        
        var purchaseButton = $('#purchaseButton');
        
        // Add a "processing" class to indicate activity
        // Remove enabled class to prevent multiple clicks
        purchaseButton.removeClass('enabled');
        purchaseButton.addClass('processing');
        
        // Use the existing URL query string and append the product_id
        // var hostURL = 
        var queryString = hostURL.search;
        if (queryString.length > 1) {
            queryString += `&product_id=${product_id}`;
        } else {
            queryString = `?product_id=${product_id}`;
        }
        // Include all url arguments passed in to this url
        var url = `${hostURL}/get_stripe_payment_link${queryString}&${window.location.search.slice(1)}`;
        console.log('Fetching payment link from:', url);

        // Get the user ID token and then execute the AJAX request
        globalUser.getIdToken(true).then(function (idToken) {
            $.ajax({
                headers: {'Authorization': 'Bearer ' + idToken},
                url: url,
                method: 'GET',
                success: function (data) {
                    // Upon success, remove "processing" class and handle the received data
                    purchaseButton.removeClass('processing');
                    console.log('Received data:', data);
                    var decodedData = JSON.parse(data);
                    var paymentUrl = decodedData.url;
                    
                    // Open the Stripe checkout in a new tab
                    // window.open(paymentUrl, '_blank');
                    // Don't do new tab
                    window.location.href = paymentUrl;
                },
                error: function (jqXHR, textStatus, errorThrown) {
                    // Handle any errors during the AJAX request
                    purchaseButton.removeClass('processing');
                    // requestErrorHandler(jqXHR, textStatus, errorThrown);
                    // error_message = jqXHR.responseJSON.error;
                    console.log(jqXHR)
                    responseText = jqXHR.responseText;
                    console.error('Error fetching payment link:', responseText);
                    $('#status-message').text('Error fetching payment link: ' + responseText).addClass('error-box');
                }
            });
        }).catch(function (error) {
            // Handle errors in getting the ID token
            console.log('Error getting user ID token:', error);
            purchaseButton.removeClass('processing');
            // Put error message in status and add class error-box
            $('#status-message').text('Error getting user ID token: ' + error);
            $('#status-message').addClass('error-box');

        });
    }



</script>

      </div>
  </section>
  
</body>
</html>
