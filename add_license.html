---
layout: ee_page_layout
title: Add Eagle Eyes License (Admin)
permalink: /add_license/
---

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Password Prompt</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    <!-- Import JQuery -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <link rel="stylesheet" href="/css/form_buttons_and_boxes.css?t=[timestamp]">

</head>

<body>
    <script>

        var useLocalFirebaseEmulator = true;  // When running local emulator with "firebase emulators:start", set this to "true
        var hostURL = useLocalFirebaseEmulator ? 'http://127.0.0.1:5001/eagleeyessearch/us-central1' : 'https://us-central1-eagleeyessearch.cloudfunctions.net';

        function requestErrorHandler(jqXHR, textStatus, errorThrown) {
            console.log("Error: " + errorThrown);
            console.log("Status: " + textStatus);
            console.log("Response: " + jqXHR.responseText);
        }

        function addLicense() {
            var fetch_url = hostURL + '/generate_download_link?filePath=' + filePath;

            // Pack the form data into an object
            var formInputs = document.querySelectorAll('input[type=text], input[type=password], input[type=checkbox], input[type=radio], select, textarea');
            var formData = {};
            for (var i = 0; i < formInputs.length; i++) {
                var input = formInputs[i];
                if (input.type === 'checkbox' || input.type === 'radio') {
                    formData[input.name] = input.checked;
                } else {
                    formData[input.name] = input.value;
                }
            }

            console.log("Checking URL: " + fetch_url);
            console.log("Fetch URL: " + fetch_url);
            globalUser.getIdToken(true).then(function (idToken) {

                $.ajax({
                    url: fetch_url,
                    data: JSON.stringify(formData),
                    type: 'POST', // Changed from 'method' to 'type' for clarity, though both are acceptable. Use 'POST' since you're sending a body.
                    contentType: 'application/json', // This sets the Content-Type header to application/json
                    headers: {
                        'Authorization': 'Bearer ' + idToken
                    },
                    success: function (data) {
                        data = JSON.parse(data);
                        console.log("Success: " + data);
                        var downloadLink = data.url;
                        console.log("Download link: " + downloadLink);

                        // Show user message with link and ask them if they want to download
                        // If yes, then redirect to the link
                        // If no, then do nothing

                        window.location.href = downloadLink;
                        $("#signin").hide();
                        $("#form").hide();
                        $("#post-download").show();
                        $("#download-link").attr("href", downloadLink);


                    },
                    error: requestErrorHandler,
                });
            });

        }

    </script>

    <style>
        input[type=text],
        input[type=password] {
            width: 80%;
            padding: 12px 20px;
            margin: 8px 0;
            display: inline-block;
            border: 1px solid #ccc;
            box-sizing: border-box;
        }
    </style>

    <!-- <button onclick="getDownloadLink()">Get Download Link</button> -->


    <!-- <form onsubmit="decryptAndRedirect(event)">
    <label for="password">Password:</label>
    <input type="password" id="password" name="password" required>
    <button type="submit">Submit</button>
</form> -->


    <br />

    <section id="signin">
        <h1>Add a License</h1>

        Eagle Eyes Scan is a desktop app, available for MacOS and Windows.

        <h3> Step 1: Sign in </h3>

        {% include signinWidget.html %}
        <script>

            var globalUser = null;

            document.addEventListener('signInComplete', function (e) {
                /* Handle the event:
                CustomEvent('signInComplete', { detail: { user: user } })
                Generated by the signinWidget.html inclusion
                */
                globalUser = e.detail.user;
                console.log('signInComplete event received: ' + globalUser);
                $("#form").show();
            });

        </script>



    </section>

    <section id="form" hidden>

        <h3> Step 2: Enter additional info, get download link </h3>
        <form onsubmit="event.preventDefault(); getDownloadLink();">
            <div class="container">

                <label for="license_name"><b>License Name: </b></label>
                What to call this license
                <br />
                <input type="text" placeholder="Example County SAR Trial " name="license_name" required>
                <br />

                <label for="emails"><b>Emails: </b></label>
                Comma-separated list of emails to add to this license
                <br />
                <input type="text" placeholder="joe@example.com,bob@example.com" name="emails" required>
                <br />

                <label for="domains"><b>Domains: </b></label>
                Comma-separated list of domains to add to this license
                <br />
                <input type="text" placeholder="examplecountysar.org,someotherdomain.com" name="domains" required>
                <br />

                <label for="location"><b>Location</b></label>: City/town, State/Province, Country
                <br />
                <input type="text" placeholder="Example Springs, Examplebama, USA" name="location" required>
                <br />

                <label for="expiry"><b>Use case: </b></label> What are you interested in using Eagle Eyes for?
                <br />
                <!-- Height of 5-->
                <textarea placeholder="To locate ..." name="reason" style="height: 100px;  width:80%; resize: vertical;"
                    required></textarea>
                <br />

                <label for="equipment"><b>Equiptment: </b></label> What drones/aircraft/equiptment/software do you use?
                <br />
                <!-- Height of 5-->
                <textarea placeholder="DJI M3T with RC-Pro controller, DroneDeploy, ..." name="equipment"
                    style="height: 100px;  width:80%; resize: vertical;" required></textarea>
                <br />

                <label for="checkboxes"> <b>Terms: </b>Please acknowledge the following:</label>
                <div class="checkboxes">
                    <div class="checkbox-container">
                        <input type="checkbox" id="understand_prototype" name="understand_prototype" required>
                        <label for="understand_prototype"><span class="checkbox-label">I understand that this is
                                prototype software - it may have bugs and may not work as expected.</span></label>
                    </div>


                    <div class="checkbox-container">
                        <input type="checkbox" id="evaluation_purposes" name="evaluation_purposes" required>
                        <label for="evaluation_purposes"><span class="checkbox-label">I understand that this is for
                                evaluation purposes only, and do not hold Eagle Eyes Search Inc responsible for anything
                                arising from use of this software.</span></label>
                    </div>

                    <div class="checkbox-container">
                        <input type="checkbox" id="assistant_not_replacement" name="assistant_not_replacement" required>
                        <label for="assistant_not_replacement"><span class="checkbox-label">I understand that the Eagle
                                Eyes computer vision system is an assistant - not a replacement for a human spotter. It
                                provides suggestions that can help spot things a human would miss, but also can miss
                                things that a human would notice. The operator should always look over the raw footage
                                with their own eyes.</span></label>
                    </div>

                    <div class="checkbox-container">
                        <input type="checkbox" id="software_distribution" name="software_distribution" required>
                        <label for="software_distribution"><span class="checkbox-label">I acknowledge that this software
                                is for my use only, and I will not distribute it.</span></label>
                    </div>
                </div>


                <button type="submit" class="registerbtn">Submit and start download</button>
                <br />



            </div>
        </form>
    </section>

</body>