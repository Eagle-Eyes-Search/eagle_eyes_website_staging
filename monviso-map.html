<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Monviso Location Map</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        body, html {
            margin: 0;
            padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #ffffff;
        }
        
        /* Make borders match webpage background */
        #map, #liveMap, .leaflet-container, .map-container, .map-wrapper, 
        .leaflet-pane, .leaflet-tile, .leaflet-control-container, 
        .leaflet-control, .leaflet-control-zoom, .leaflet-control-attribution, 
        .leaflet-popup, .leaflet-popup-content-wrapper {
            border: 1px solid #ffffff !important;
            outline: none !important;
            background: #ffffff !important;
            box-shadow: none !important;
        }
        
        .map-container {
            width: 100%;
            margin: 0 auto;
            padding: 20px 0;
            background: #ffffff;
        }
        
        #map {
            width: 100%;
            height: 550px;
            border: 1px solid #ffffff !important;
            outline: none !important;
            box-shadow: none !important;
            background: #ffffff !important;
            overflow: hidden;
        }
        
        /* Remove scrollbar */
        .leaflet-container {
            overflow: hidden !important;
        }
        
        /* Safety hint overlay */
        .safety-hint {
            position: absolute;
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 8px 12px;
            border-radius: 4px;
            font-size: 12px;
            z-index: 1000;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.2s;
        }
        
        .safety-hint.visible {
            opacity: 1;
        }
        
        @media (max-width: 768px) {
            #map {
                height: 400px;
            }
            .map-container {
                padding: 10px 0;
            }
        }
    </style>
</head>
<body>
    <div class="map-container">
        <div id="map">
            <div class="safety-hint" aria-live="polite">Click in map, then hold Ctrl or âŒ˜ to zoom and pan</div>
        </div>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        // Initialize map with all interactions disabled by default
        const map = L.map('map', {
            center: [44.667832, 7.090793], // Monviso coordinates
            zoom: 6,
            scrollWheelZoom: false,
            dragging: false,
            touchZoom: false,
            doubleClickZoom: false,
            keyboard: true,
            zoomControl: true,
            attributionControl: true
        });

        // Add OpenTopoMap basemap
        L.tileLayer('https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, <a href="https://opentopomap.org/">OpenTopoMap</a>',
            maxZoom: 17
        }).addTo(map);

        // Add Monviso marker
        const monvisoMarker = L.marker([44.667832, 7.090793]).addTo(map);
        monvisoMarker.bindPopup('<strong>Monviso (Monte Viso)</strong><br>3,841m - Highest peak in the Cottian Alps<br>Italian Mountain Rescue Corps (CNSAS) operation site');

        // Get hint element and map element
        const safetyHint = document.querySelector('.safety-hint');
        const mapElement = document.getElementById('map');
        let isModifierPressed = false;

        // Global key event handlers
        window.addEventListener('keydown', function(e) {
            if (e.ctrlKey || e.metaKey) {
                isModifierPressed = true;
                map.scrollWheelZoom.enable();
                map.dragging.enable();
                map.touchZoom.enable();
                map.doubleClickZoom.enable();
                safetyHint.classList.remove('visible');
            }
        });

        window.addEventListener('keyup', function(e) {
            if (!e.ctrlKey && !e.metaKey) {
                isModifierPressed = false;
                map.scrollWheelZoom.disable();
                map.dragging.disable();
                map.touchZoom.disable();
                map.doubleClickZoom.disable();
            }
        });

        // Show hint when hovering over map without modifier key
        mapElement.addEventListener('pointerenter', function() {
            if (!isModifierPressed) {
                safetyHint.classList.add('visible');
            }
        });

        mapElement.addEventListener('pointerleave', function() {
            safetyHint.classList.remove('visible');
            if (!isModifierPressed) {
                map.scrollWheelZoom.disable();
                map.dragging.disable();
                map.touchZoom.disable();
                map.doubleClickZoom.disable();
            }
        });

        // Prevent wheel events from bubbling when zoom is disabled
        mapElement.addEventListener('wheel', function(e) {
            if (!map.scrollWheelZoom.enabled()) {
                e.stopPropagation();
            }
        });

        // Handle window resize
        window.addEventListener('resize', function() {
            map.invalidateSize();
        });
    </script>
</body>
</html> 