---
layout: ee_page_layout
title: Register for Eagle Eyes Scan SAR
permalink: /register/
---

<!--
To do:
- Create a request_handler named "submit_register_form" inspired by "generate_download_link" that makes use of "add_signup_form_data_to_database" to submit the data into the database
- Add the "submit_register_form" to the API in main.py
- Add isEmulator logic from get_licensed page to be able to test this page locally using firebase emulator
- Test function locally
- Create function "retrieveExistingData" to prefill the form with details from get_scan form
- Create function "isFormAlreadyCompleted()" to redirect users directly to the next page
-->


<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Register for Eagle Eyes Scan SAR</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <link rel="custom-stylesheet" href="/css/form_buttons_and_boxes.css?t=[timestamp]">
    {% include form_styling.html %}

</head>
<body>        
    <section id="signin" class="form-container" hidden>
        <h3>Sign in</h3>
        {% include signinWidget.html %}

        <script>
            var globalUser = null;

            var backUpLinkOrNull = null;
            console.log("Signin widget included");
            document.addEventListener('signInComplete', function (e) {
                /* Handle the event:
                CustomEvent('signInComplete', { detail: { user: user } })
                Generated by the signinWidget.html inclusion
                */
                globalUser = e.detail.user;
                console.log('signInComplete event received: ' + globalUser);
                $("#signin").hide();
                $("#form").show();

                // Send a request to the server to see if the user has already filled out the form. 
                // If they have not - show it, if they have, show a greeting message and the download link.
                // // hostURL = getHostUrl();
                // var fetch_url = hostURL + '/has_user_already_filled_in_form';
                // console.log("Checking URL: " + fetch_url);
                // // $("#hang-on-message").show();
                // globalUser.getIdToken(true).then(function (idToken) {
                //     $.ajax({
                //         url: fetch_url,
                //         type: 'GET',
                //         headers: {

                //             'Authorization': 'Bearer ' + idToken

                //         },
                //         success: function (data) {
                //             $("#hang-on-message").hide();

                //             console.log("Got reply from has_user_already_filled_in_form: " + data);
                //             data = JSON.parse(data);
                //             formOrNull = data.form
                //             backUpLinkOrNull = data.backupLink;
                //             if (formOrNull === null) {
                //                 $("#form").show();

                //                 $("#download-button-div").show();
                //             } else {
                //                 // Show a welcome back message with name and team 

                //                 userName = formOrNull.name || "(Unknown user)";
                //                 userTeam = formOrNull.team || "(Unknown team)";
                //                 $("#welcome-back-message").text("Welcome back, " + userName + " from " + userTeam + ". Your download link is below.");
                //                 $("#welcome-back-message").show();
                //                 // Set Download button text to "Downlaod again" (it's the only button in the div)
                //                 $("#download-button-div button").text("Download again");
                //                 $("#download-button-div").show()
                //             }
                //         },
                //         error: requestErrorHandler,
                //     });
                // });


            });

        </script>

    </section>
    <section class="form-container">
        <h1 style="text-align: center;">Register for an Eagle Eyes Scan SAR license</h1>
        <p>Purchasing an Eagle Eyes Scan SAR license requires registration. Please fill out this form to register your organisation. We will process new request within 3 business days. Upon approval, you will be able to purchase a license using email address above.</p>
    </section>
    {% include register_form.html %}
    
</body>