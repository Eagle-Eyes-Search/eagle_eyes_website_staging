---
layout: ee_page_layout
title: Register for Eagle Eyes Scan SAR
permalink: /register/
---

<!--
To do:
- Create a request_handler named "submit_register_form" inspired by "generate_download_link" that makes use of "add_signup_form_data_to_database" to submit the data into the database
- Add the "submit_register_form" to the API in main.py
- Add isEmulator logic from get_licensed page to be able to test this page locally using firebase emulator
- Test function locally
- Create function "retrieveExistingData" to prefill the form with details from get_scan form
- Create function "isFormAlreadyCompleted()" to redirect users directly to the next page
-->


<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Register for Eagle Eyes Scan SAR</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <link rel="custom-stylesheet" href="/css/form_buttons_and_boxes.css?t=[timestamp]">

    <style>

        html, body {
            width: 100%;
            margin: 0;
            padding: 0;
            box-sizing: border-box; /* Ensures padding does not affect the width */
        }

        .form-container {
            background: white;
            padding: 20px; /* This padding affects the inner content width */
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            width:100%;
            max-width: 750px;
            margin: 0 auto 50px;
            transition: width 0.3s ease-in-out;
        }

        h1 {
            color: #333;
            font-size: 24px;
        }

        p {
            font-size: 16px;
            color: #666;
        }

        label {
            font-size: 16px;
            color: #333;
            display: block;
            margin-bottom: 5px;
            width: 100%; /* Ensure labels take the full available width */
        }

        input[type="text"],
        input[type="url"],
        input[type="email"],
        textarea {
            width: calc(97%); 
            padding: 10px;
            margin-bottom: 15px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }

        input::placeholder, textarea::placeholder {
            color: #ccc;
            font-style: italic;
        }

        input:focus::placeholder, textarea:focus::placeholder {
            color: transparent;
        }

        .radio-group {
            width: calc(100%); /* Adjust if the radio buttons also need to fit inside the padding */
            margin: 10px 0 20px;
        }

        .radio-group label {
            margin-right: 20px;
            color: #666;
            font-size: 16px;
        }

        button {
            background-color: #007BFF;
            color: white;
            border: none;
            padding: 10px 20px; /* Adjust padding to control the width indirectly */
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            display: block;
            width: auto; /* Auto width based on content and padding */
            margin: 0 auto 0 auto; /* Center the button */
        }

        button:hover {
            background-color: #0056b3;
        }

        #submit-container {
            display: flex;
            justify-content: center; /* Aligns horizontally */
            width: 100%; /* Ensures the section takes full width */
        }

        /* Responsive adjustment for smaller screens */
        @media (max-width: 768px) {
            .form-container {
                width: 100%; /* Full width on smaller screens */
            }
        }
    </style>
</head>
<body>
    <script>

        var useLocalFirebaseEmulator = getIsEmulatorFromURL();  // When running local emulator with "firebase emulators:start", set this to "true
        var hostURL = useLocalFirebaseEmulator ? 'http://127.0.0.1:5001/eagleeyessearch/us-central1' : 'https://us-central1-eagleeyessearch.cloudfunctions.net';

        function getIsEmulatorFromURL() {
            const urlParams = new URLSearchParams(window.location.search);
            // return urlParams.get('is_emulator') === 'true';
            // Case insensitive
            return urlParams.get('is_emulator')?.toLowerCase() === 'true';
        }

        function requestErrorHandler(jqXHR, textStatus, errorThrown) {
            $("#hang-on-message").hide();
            console.log("Error: " + errorThrown);
            console.log("Status: " + textStatus);
            console.log("Response: " + jqXHR.responseText);
            showError("Error: " + errorThrown + " Status: " + textStatus + " Response: " + jqXHR.responseText);
        }

        function showError(message) {
            // Show an error message to the user
            var errorBox = document.createElement('div');
            errorBox.classList.add('error-box');
            // Width 80% of the screen
            errorBox.style.width = '80%';
            // Center horizontally
            errorBox.style.margin = '0 auto';

            errorBox.textContent = message;
            // Append to end of 'end-of-page' div
            // document.getElementById('end-of-page').appendChild(errorBox);
            document.body.appendChild(errorBox);

            // Show the "try again" button (try-again-button) (just make it not hidden)
            // $('#try-again-button').css('display', 'block');

            // Scroll to the bottom of the page
            window.scrollTo(0, document.body.scrollHeight);
        }

        function validateCheckboxes() {
            // List of all checkbox IDs
            var checkboxIds = [
                "information-correct",
                "receive_communication",
            ];

            // Check if all checkboxes are checked
            for (var i = 0; i < checkboxIds.length; i++) {
                if (!document.getElementById(checkboxIds[i]).checked) {
                    alert("Please check all the boxes before submitting.");
                    return false; // Prevent form submission
                }
            }

            return true; // All checkboxes are checked, allow form submission
        }

        function processForm() {
            // exit function when form not validated
            if (!validateCheckboxes()) { 
                console.log("Something wrong with the checkboxes");
                return;  
            }

            // Add "processing" class to the submit button
            $("#submitButton").addClass('processing');

            // Pack the form data into an object
            var formData = {};
            var formInputs = document.querySelectorAll('input[name], select[name], textarea[name]');
            for (var i = 0; i < formInputs.length; i++) {
                var input = formInputs[i];

                if (input.type === 'checkbox') {
                    // Set 'yes' if the checkbox is checked, 'no' if it's not
                    formData[input.name] = input.checked ? 'yes' : 'no';
                } else if (input.type === 'radio') {
                    // Only set the value if the radio button is checked
                    if (input.checked) {
                        formData[input.name] = input.value;
                    }
                } else {
                    // Handle all other input types
                    formData[input.name] = input.value;
                }
            }
            console.log(formData);

            sendForm(formData);
        }
        
        function sendForm(formData) {
            var fetch_url = hostURL + '/submit_register_form';

            console.log("Fetch URL: " + fetch_url);

            globalUser.getIdToken(true).then(function (idToken) {

                $.ajax({
                    url: fetch_url,
                    data: JSON.stringify(formData),
                    type: 'POST', // Changed from 'method' to 'type' for clarity, though both are acceptable. Use 'POST' since you're sending a body.
                    contentType: 'application/json', // This sets the Content-Type header to application/json
                    headers: {
                        'Authorization': 'Bearer ' + idToken
                    },
                    success: function (data) {
                        console.log("Success" + data);

                        // Show user message with link and ask them if they want to download
                        // If yes, then redirect to the link
                        // If no, then do nothing

                        // Hide the download button/div after submitting form
                        $("#form").hide();
                        $("#signin").hide();
                        $("#post-submit").show();
                    },
                    error: requestErrorHandler,
                });
            });
        }

        // On load - check whether to show the emulator info box
        $(document).ready(function () {
            if (useLocalFirebaseEmulator) {
                $('#using-emulator-info').show();
            }
        });


    </script>
    </br>
    <div class="form-container">
        <section id="signin" hidden>
            <h3>Sign in</h3>
            {% include signinWidget.html %}

            <script>
                var globalUser = null;

                var backUpLinkOrNull = null;
                console.log("Signin widget included");
                document.addEventListener('signInComplete', function (e) {
                    /* Handle the event:
                    CustomEvent('signInComplete', { detail: { user: user } })
                    Generated by the signinWidget.html inclusion
                    */
                    globalUser = e.detail.user;
                    console.log('signInComplete event received: ' + globalUser);
                    $("#signin").hide();
                    $("#form").show();

                    // Send a request to the server to see if the user has already filled out the form. 
                    // If they have not - show it, if they have, show a greeting message and the download link.
                    // // hostURL = getHostUrl();
                    // var fetch_url = hostURL + '/has_user_already_filled_in_form';
                    // console.log("Checking URL: " + fetch_url);
                    // // $("#hang-on-message").show();
                    // globalUser.getIdToken(true).then(function (idToken) {
                    //     $.ajax({
                    //         url: fetch_url,
                    //         type: 'GET',
                    //         headers: {

                    //             'Authorization': 'Bearer ' + idToken

                    //         },
                    //         success: function (data) {
                    //             $("#hang-on-message").hide();

                    //             console.log("Got reply from has_user_already_filled_in_form: " + data);
                    //             data = JSON.parse(data);
                    //             formOrNull = data.form
                    //             backUpLinkOrNull = data.backupLink;
                    //             if (formOrNull === null) {
                    //                 $("#form").show();

                    //                 $("#download-button-div").show();
                    //             } else {
                    //                 // Show a welcome back message with name and team 

                    //                 userName = formOrNull.name || "(Unknown user)";
                    //                 userTeam = formOrNull.team || "(Unknown team)";
                    //                 $("#welcome-back-message").text("Welcome back, " + userName + " from " + userTeam + ". Your download link is below.");
                    //                 $("#welcome-back-message").show();
                    //                 // Set Download button text to "Downlaod again" (it's the only button in the div)
                    //                 $("#download-button-div button").text("Download again");
                    //                 $("#download-button-div").show()
                    //             }
                    //         },
                    //         error: requestErrorHandler,
                    //     });
                    // });


                });

            </script>

        </section>
    
        <section id="form" hidden>

            <h1 style="text-align: center;">Register for an Eagle Eyes Scan SAR license</h1>
            <p>Purchasing an Eagle Eyes Scan SAR license requires registration. Please fill out this form to register your organisation. We will process new request within 3 business days. Upon approval, you will be able to purchase a license using email address above.</p>

            <form id="register-form" onsubmit="event.preventDefault(); processForm(); return false;">
                <label for="name"><b>Name:</b> Your full name</label>
                <input type="text" id="name" name="name" placeholder="Firstname Lastname" required>

                <label for="team"><b>Organization Name:</b> Your team/company/agency, or enter "Individual" if you are not part of an organization</label>
                <input type="text" id="team" name="team" placeholder="Enter your organization's name" required>

                <label for="website"><b>Organization Website:</b></label>
                <input type="text" id="website" name="website" placeholder="http://www.example.com" required>

                <label for="location"><b>Location:</b> City, State/Province, Country</label>
                <input type="text" id="location" name="location" placeholder="Example Springs, Examplebama, USA" required>

                <label><b>Organization Type:</b></label>
                <div class="radio-group">
                    <label><input type="radio" name="org_type" id="public" value="public" required> Public</label>
                    <label><input type="radio" name="org_type" id="private" value="private" required> Private</label>
                    <label><input type="radio" name="org_type" id="non-profit" value="non-profit" required> Non-Profit</label>
                    <label><input type="radio" name="org_type" id="other" value="other" required> Other</label>
                </div>

                <label for="use-case"><b>What are you interested in using Eagle Eyes for?</b></label>
                <textarea id="use-case" name="use_case" placeholder="To locate ... so I can ..." rows="4" required></textarea>

                <label for="questions"><b>Questions or remarks:</b></label>
                <textarea id="questions" name="questions" placeholder="" rows="4"></textarea>

                <label for="checkboxes"> <b>Terms: </b>Please acknowledge the following:</label>
                <div class="checkboxes">
                    <div class="checkbox-container">
                        <input type="checkbox" id="information-correct" name="assistant_not_replacement" required>
                        <label for="assistant_not_replacement"><span class="checkbox-label">I confirm that all information provided is accurate and true. <b>required</b></span></label>
                        </div>

                    <div class="checkbox-container">
                        <input type="checkbox" id="receive_communication" name="receive_communication" required>
                        <label for="receive_communication"><span class="checkbox-label">I agree to receive communications specific to my registration request and related product information. <b>required</b></span></label>
                    </div>

                    <div class="checkbox-container">
                        <input type="checkbox" id="receive_newsletter" name="receive_newsletter">
                        <label for="receive_newsletter"><span class="checkbox-label">I want to receive updates about Eagle Eyes Search.</span></label>
                    </div>
                </div>
                </br>
                <div id="submit-container">
                    <button id='submitButton' type="submit">Submit</button>
                </div>
            </form>
        </section>

        <section id="post-submit" class="info-box" hidden> 
            <div id="checking-licenses-box" class="info-box" >Your registration request was submitted successfully.  Please give us 3 business days to approve.  If your situation is urgent, or you have not heard back from us after this time, feel free to reach out at info@eagleeyessearch.com</div>
        </section>
    </div>
</body>